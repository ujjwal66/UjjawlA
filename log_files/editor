Drawningboard=function(){var n=this;n.isSave=!1;n.model;n.dom;n.loading;n.position=[];n.engine=0;n.workspace;n.selector;n.saveDisabled=!1;n.flowtab;n.informationtab;n.contexttab;n.toolbar;n.alignbar;n.helpbar;n.currentstate=-1;n.messagemenu;n.ownerkey=window.__ownerkey;n.ownerloginkey;n.ownermode=!1;n.fullaccess=!1;n.svgaccess=!1;n.editiconid=undefined;n.background;n.width;n.height;n.cliplist=[];n.recentcolors=[];n.fontlist=[];n.clipid=0;n.groupid=0;n.freemailquantity=0;n.logosourceid=_logosourceid;n.categorysourceid=_categorysourceid;n.textmeasurer;n.isOpera=!!window.opera||navigator.userAgent.indexOf(" OPR/")>=0;n.isFirefox=typeof InstallTrigger!="undefined";n.isSafari=Object.prototype.toString.call(window.HTMLElement).indexOf("Constructor")>0;n.isIOS=navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/iPad/i);n.isChrome=!!window.chrome&&!n.isOpera;n.isIE=/*@cc_on!@*/!1||!!document.documentMode;n.isTouch=$.touchSupport();n.api=new Api;n.companyname=decodeURIComponent(getQueryVariable("companyname"));n.category=getQueryVariable("category");n.icon=getQueryVariable("logo");n.mode=getQueryVariable("mode");n.firstdisplay=!0;n.plan=undefined;typeof fbq!="undefined"&&fbq("track","open_editor",{logo_id:n.icon,owner_mode:n.mode});n.dominantcolor;n.showbackground=!1;n.fontsloaded=!1;n.start=function(){var i=Cookies.get("ownerloginkey"),t;n.ownerloginkey=window.__ownerloginkey||i;Cookies.set("ownerloginkey",n.ownerloginkey);$("body").on("dragover",function(n){n.stopPropagation();n.preventDefault();n.originalEvent.dataTransfer.dropEffect="copy"});$("body").on("drop",function(n){n.stopPropagation();n.preventDefault()});n.dom=$("#workspace");n.loading=$(".master-loading");n.startloading();colpick(n);t=$('<svg id="textmeasurer"><\/svg>');$("#drawningboard").append(t);n.textmeasurer=Snap(t[0]);n.width=n.dom.width();n.height=n.dom.height();n.predraw()};n.loadfonts=function(t,r){if(typeof t!="undefined"&&t!=null&&t.length>0)for(i=0;i<t.length;i++)t[i].name=t[i].name.replace(/['"]+/g,"");$.ajax({type:"post",url:n.api.font+"list",data:JSON.stringify({fontlist:t}),contentType:"application/json; charset=utf-8",dataType:"json"}).done(function(i){n.fontlist=i.obj;t||(n.fontsloaded=!0);var u='<style type="text/css">';$.each(n.fontlist,function(t,i){if(i.name){var r=n.getFontFileName(i.name),f=i.bold==1,e=i.italic==1;u+='@font-face {font-family:"'+i.name+'";';u+='src:url("'+n.getFontUrl(r,!1,!1)+'");}';e&&(u+='@font-face {font-family:"'+i.name+'";',u+='src:url("'+n.getFontUrl(r,!1,!0)+'");',u+="font-style: italic;} ");f&&(u+='@font-face {font-family:"'+i.name+'";',u+='src:url("'+n.getFontUrl(r,!0,!1)+'");',u+="font-weight: bold;} ");f&&e&&(u+='@font-face {font-family:"'+i.name+'";',u+='src:url("'+n.getFontUrl(r,!0,!0)+'");',u+="font-style: italic;",u+="font-weight: bold;} ")}});u+="<\/style>";$("head").prepend(u);r&&r()})};n.getFontUrl=function(n,t,i){var r=new Textformat;return r.font=n,r.bold=t,r.italic=i,"/Content/clientfonts/"+r.getFontFileName()+".woff"};n.awaitfonts=function(t,i){return n.loadfonts(t,function(){Promise.all([new Promise(function(i){n.watchfonts(t,i)}),n.loadOpenTypeFonts(t)]).then(i).catch(i)})};n.loadOpenTypeFonts=function(t){return new Promise(function(i,r){for(var e,u,o=[],f=0,s=t.length;f<s;f++)u=t[f],e=n.getFontUrl(u.name,u.bold,u.italic),o.push(TextPath.FontLoader.loadFont(e).catch(function(n){r(new Error('Failed to load font from "'+e+'". '+n.message))}));Promise.all(o).then(i)})};n.watchfonts=function(n,t){var i,f;n.length<1&&t();var r=0,u=function(i){r++;document.body.removeChild(i);r===n.length&&t()},e=function(n){var t=document.createElement("span");return t.innerText="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",t.style.fontFamily=n.name,t.style.fontWeight=n.bold?"bold":"",t.style.fontStyle=n.italic?"italic":"",t.style.visibility="hidden",t.style.position="absolute",t.style.right="100%",document.body.appendChild(t),t},o=function(n){var t=e(n);fontSpy(n.name,{glyphs:"giItT1WQy@!-/#",success:function(){u(t);t=null},failure:function(){u(t);t=null}})};for(i=0,f=n.length;i<f;++i)o(n[i])};n.predraw=function(){n.flowtab=new Flowtab(n);n.informationtab=new Informationtab(n);n.contexttab=new Contexttab(n);n.toolbar=new Toolbar(n);n.alignbar=new Alignbar(n);n.helpbar=new Helpbar(n);(n.isSafari||n.isTouch)&&n.fixSafari();n.isIOS&&$("html").addClass("ipad ios7");n.registerEvents();n.draw()};n.fixSafari=function(){$("body").height(window.innerHeight);$("#logomaker").height(window.innerHeight);$("#logobody").height(window.innerHeight);window.scrollTo(0,0)};n.draw=function(){n.workspace=Snap("#workspace");n.workspace.attr("text-rendering","geometricPrecision");n.dom.on("contextmenu",function(){return!1});n.showtooltips();n.background=new Background(n);n.position=$("#drawningboard").position();n.selector=new Selector(n);n.ownerkey&&n.ownerkey!="false"?n.startownermode():n.toolbar.drawinitialelements()};n.startownermode=function(){n.ownermode=!0;n.fullaccess=window.__fullaccess||!1;n.svgaccess=window.__svgaccess||!1;n.toolbar.startownermode();n.loadfonts(undefined,function(){n.endloading()})};n.undraw=function(){n.workspace.clear();n.selector.finish();n.background.finish()};n.confirmmessage=function(){n.messagemenu&&n.messagemenu.confirm()};n.reset=function(){n.selector.unselect();n.selector.endexplodedmode();n.selector.closecontext();n.undraw();$.each(n.cliplist,function(n,t){t.finish()});n.currentstate=-1;n.cliplist.splice(0);n.editiconid=undefined;n.toolbar.setdominantcolor("rgba(255, 255, 255, 0)");n.firstdisplay=!0;n.draw();n.selector.changed=0;n.clipid=0;n.groupid=0;n.dom.hide();n.dom.slideUp("fast",function(){n.dom.slideDown("fast")})};n.select=function(t){n.selector.select(t)};n.formatsvg=function(n){n.find("img.svg").each(function(){var t=jQuery(this),i=t.attr("id"),r=t.attr("class"),u=t.attr("src");jQuery.get(u,function(u){var f=jQuery(u).find("svg");typeof i!="undefined"&&(f=f.attr("id",i));typeof r!="undefined"&&(f=f.attr("class",r+" replaced-svg"));f=f.removeAttr("xmlns:a");t.replaceWith(f);n.find("svg").show()},"xml")})};n.showtooltips=function(){/iPad/i.test(navigator.userAgent)||$(document).tooltip({show:{effect:"drop",direction:"up",duration:"fast"},position:{my:"left top+10",at:"left bottom"},close:function(n,t){t.tooltip.hide()}})};n.registerEvents=function(){$(window).on("resize",function(){n.width=n.dom.width();n.height=n.dom.height();n.selector.redrawbg()});$(window).on("orientationchange",function(){(n.isSafari||n.isTouch)&&(n.fixSafari(),n.isIOS&&$("html").addClass("ipad ios7"))});window.onbeforeunload=function(){if(!n.isSave)return"Are you sure you want to quit without saving ?"}};n.addrecentcolor=function(t){var i=!1;$.each(n.recentcolors,function(n,r){t.r==r.r&&t.g==r.g&&t.b==r.b&&t.a==r.a&&(i=!0)});i||(n.recentcolors.unshift(t),n.recentcolors.length==7&&n.recentcolors.pop())};n.startloading=function(){n.loading.fadeIn()};n.isSaveDisabled=function(){return n.saveDisabled};n.validateData=function(){for(var i=!1,t=0,r=n.cliplist.length;t<r;t++)if(n.cliplist[t].alpha==1){i=!0;break}i?n.enableSave():n.disableSave()};n.disableSave=function(){$("#save-work, .flowtab .item.preview").removeClass("disabled").addClass("disabled");n.saveDisabled=!0};n.enableSave=function(){$("#save-work, .flowtab .item.preview").removeClass("disabled");n.saveDisabled=!1};n.endloading=function(){n.loading.hide()};n.getFontFileName=function(n){return n.replace(/\s/g,"").toLowerCase()};n.updateTextElements=function(){$.each(n.cliplist,function(n,t){typeof t.companytext!="undefined"&&t.update()})}}