window.TextPath=function(){function t(n,i){var u=n&&n.tagName?n.tagName.toLowerCase():null,e=u==="text"||u==="textpath",f=u==="path",o=f?st(n):null,r;typeof n!="object"||typeof i!="undefined"||e||f||(i=n,n=null);this._chars="";this._letters=[];this._letterBoxWidths=[];this._rootElement=f?n:rt("path");this._pathsData=[];this._renderedFontSize=null;this._pathLength=1;this._fontScaleRatio=1;this._whitespaceLength=0;this._path=null;this._container=null;this._text=n;this._initialized=!1;this.changed=!1;this.font=null;this.props=dt({},t.defaultProps);this.lastFrame=null;this.renderFrame=ft.bind(this);r=i?i.href:null;e&&(wt.call(this),r=!r&&(n.getAttribute("href")||n.getAttribute("xlink:href")));i&&this.setProps(i);o&&this.setProps(o);this.setPath(r||this.props.href)}var b=/^\s+|\s+$/gm,k=/\s+/gm,d=/(\-?\d*\.?\d+)\s*(\-?\d*\.?\d+)/gm,g=/[A-Z-a-z]+[\d\s\.,-]*/gm,h=Math.sin,c=Math.cos,nt=Math.abs,f=Math.min,e=Math.max,n=t.prototype,tt={start:0,middle:.5,end:1},it=function(n,t){var r=window.getComputedStyle(n);return y(t,{text:n.textContent,fontSize:parseFloat(r.fontSize),letterSpacing:0,offset:parseFloat(n.getAttribute("startOffset")||0)/100||0,textAnchor:r.textAnchor||"start",x:i(n.getAttribute("x"),null),y:i(n.getAttribute("y"),null),dx:i(n.getAttribute("dx"),null),dy:i(n.getAttribute("dy"),null),space:n.getAttribute("xml:space")||null,href:n.getAttribute("href")}),t},i=function(n,t){var i=parseFloat(n);return typeof n=="undefined"||isNaN(i)?t:i},r=function(n){return this._path?this._path.getPointAtLength(f(e(n,0),1)*this._pathLength):{x:n*this._textWidth,y:0}},l=function(n,t){var i=f(e(n,0),1),u=f(e(t,0),1),o,s;return i===u&&(u===1?(i=u,u=n):(u=i,i=t)),o=r.call(this,i),s=r.call(this,i+(u-i)),Math.atan2(s.y-o.y,s.x-o.x)*180/Math.PI},rt=function(n){return document.createElementNS("http://www.w3.org/2000/svg",n)},ut=function(){return!this._rootElement.parentNode},a=function(){this._pathLength=(this._path?this._path.getTotalLength():this._textWidth)||1},ft=function(){a.call(this);et.call(this,this._letters);vt.call(this);this.lastFrame=null},et=function(n){var r=this._rootElement,u=this.props.text,f,t,e,i;if(!this._initialized&&ut.call(this)&&n.length>0&&(this._text&&this._text.parentNode&&at.call(this,this._text,r),this._initialized=!0),this._chars!==u||this._pathsData.length===0)for(this._chars=u,f=this._pathsData=new Array(n.length),t=0,e=n.length;t<e;t++)i=n[t].toPathData(),i&&(f[t]=i);return r},ot=["dx","dy","x","y","letterSpacing","fontSize","offset"],st=function(n){for(var f=Object.keys(u),e={},t,r,o,i=0,s=f.length;i<s;i++)t=f[i],r="data-"+t,n.hasAttribute(r)&&(attrValue=n.getAttribute(r),o=u[t],e[u[t]]=ht(o,attrValue));return e},ht=function(n,t){return ot.indexOf(n)>-1?parseFloat(t):t==="null"?null:t||void 0},ct=function(){var t=this._rootElement,n=this.props,i=this.font;lt(t,{textpath:n.text,"text-anchor":n.textAnchor,"font-size":n.fontSize,letterspacing:n.letterSpacing,side:n.side,offset:n.offset,x:n.x,y:n.y,dx:n.dx,dy:n.dy,xmlspace:n.space,href:n.href,font:i?i.names.fontFamily.en:"","font-src":n.fontSrc,"font-scale":n.fontScale});var r=n.x||0,u=n.y||0,f=n.dx||0,e=n.dy||0;pt(t,r+f,u+e)},lt=function(n,t){for(var f=Object.keys(t),r,i,u=0,e=f.length;u<e;u++)r=f[u],i=t[r],i===null?n.removeAttribute("data-"+r,i):typeof i!="undefined"&&n.setAttribute("data-"+r,i)},at=function(n,t){for(var i=n.parentNode,r=n;i.tagName==="text"||i.tagName==="textPath";)r=i,i=r.parentNode;i.insertBefore(t,r);i.removeChild(r);this._container=i},v=function(){return this.props.letterSpacing*this._fontScaleRatio},vt=function(){for(var c=this._letters.length,f,e,a,i,u,o,s=this.props,b=this._pathsData,y=new Array(this._pathsData.length),h=s.offset,n=this._pathLength,p=v.call(this),w=p/n,k=tt[s.textAnchor],d=-((this._textWidth+p*(c-1))*k)/n,g=s.side==="right"?this._maxLetterHeight:0,t=0;t<c;t++)f=b[t],f?(i=this._letterBoxWidths[t],u=h+d,o=u+i/n,e=r.call(this,u+i*.5/n),a=l.call(this,u,o),y[t]=this._path&&(u>=1||o<=0)?"":yt(f,e.x,e.y,a,i*-.5,g),h+=i/n+w):h+=this._whitespaceLength/n+w;this._rootElement.setAttribute("d",y.join(""));ct.call(this)},yt=function(n,t,i,r,u,f){var e=r*Math.PI/180,o=i*h(e)+t*c(e)+u,s=i*c(e)-t*h(e)+f;return gt(n,o,s,r)},pt=function(n,t,i){return n.setAttribute("transform",["translate(",t,",",i,")"].join(""))},o=function(){return this._pathsData=[],this},wt=function(){!this._initialized&&this._text&&it(this._text,this.props)},bt=function(n,t){var u=this.props.letterSpacing*(n.length-1),i=this._pathLength,r=this.font.getAdvanceWidth(n,t)+u;return r>i?i/r*t:t},s=function(){var r=this.font,s,t;if(r){var i=this.props.space==="preserve"?this.props.text:this.props.text.replace(b,"").replace(k," "),u=i.length,h=new Array(u),c=new Array(u),l,a=0,n=this.props.fontSize,f=0,v,y,e;for(this._path&&this.props.fontScale==="contain"?(s=bt.call(this,i,n),this._fontScaleRatio=s/n,n=s):this._fontScaleRatio=1,n!==this._renderedFontSize&&o.call(this),this._renderedFontSize=n,t=0;t<u;t++)v=h[t]=r.getPath(i[t],0,0,n),l=c[t]=r.getAdvanceWidth(i[t],n)+kt.call(this,i,t,n),a+=l,y=v.getBoundingBox(),e=nt(y.y1),e>f&&(f=e);this._whitespaceLength=r.getAdvanceWidth(" ",n);this._letters=h;this._letterBoxWidths=c;this._textWidth=a;this._maxLetterHeight=f}},kt=function(n,t,i){var r=this.font,u=n[t],f=n[t+1];return u&&f?r.getKerningValue(r.charToGlyph(u),r.charToGlyph(f))*i/r.unitsPerEm:0},y=function(n,t){for(var o=Object.keys(t),h=o.length,u,f,r,s=!1,e=0;e<h;e++)u=o[e],f=n[u],r=t[u],typeof f!="undefined"&&typeof r!="undefined"&&f!==r&&(n[u]=typeof f=="number"?i(r):r,s=!0);return s},dt=function(n,t){for(var r,u=Object.keys(t),i=0,f=u.length;i<f;i++)r=u[i],n[r]=t[r];return n},gt=function(n,t,i,r){if(n){t||(t=0);i||(i=0);r||(r=0);var u=r*Math.PI/180,f=Math.cos(u),e=Math.sin(u),o=function(n,r,u){var h=parseFloat(r),c=parseFloat(u),o,s;return o=f*(h+t)-e*(c+i),s=e*(h+t)+f*(c+i),(o<0?"":" ")+o.toString()+(s<0?"":" ")+s.toString()};return n.replace(g,function(n){return n.replace(d,o)})}},p,w,u;return n.getElement=function(){return this._rootElement},n.appendTo=function(n){return n.appendChild(this._rootElement),this},n.renderAsync=function(){return this.font||this.render(),window.requestAnimationFrame?(this.lastFrame&&cancelAnimationFrame(this.lastFrame),this.lastFrame=requestAnimationFrame(this.renderFrame)):(this.lastFrame&&clearTimeout(this.renderFrame),this.lastFrame=setTimeout(this.renderFrame,30)),this},p=function(){},n.render=function(n){n||(n=p);var i=this;return!i.font&&i.props.fontSrc?t.FontLoader.getFont(i.props.fontSrc,function(t,r){t?n(t,i):(i.setFont(r),i.renderFrame(),i.changed=!1,n(null,i))}):(i.renderFrame(),i.changed=!1,n(null,i)),i},w=function(n){return this.font&&this.changed&&(this._fontScaleRatio<1||n.letterSpacing!=null||typeof n.text=="string"||typeof n.fontScale=="string")},n.setProps=function(n){return this.changed=y(this.props,n),(this.changed||typeof n.fontSrc!="undefined")&&(this.font=null),typeof n.href!="undefined"&&this.setPath(n.href),w.call(this,n)&&s.call(this),this},n.setPath=function(n){var t=n;if(n&&typeof n=="string")try{t=document.querySelector(n)}catch(i){t=null}return t!==this._path&&(this._path=t,a.call(this),this.changed=!0),s.call(this),this},n.setFont=function(n){return n!==this.font&&(this.font=n,o.call(this),s.call(this)),this},n.getTextWidth=function(n){return n?this._textWidth+Math.max(this.props.text.length-1,0)*v.call(this):this._textWidth},n.getTextHeight=function(){if(!this.font)return 0;var n=this.font;return Math.abs(n.ascender-n.descender)/n.unitsPerEm*this.props.fontSize*this._fontScaleRatio},n.destroy=function(){this._letters=null;this._letterBoxWidths=null;this._pathsData=null;this._rootElement=null;this._path=null;this._text=null;this._container=null;this._initialized=!1;this.font=null;this.changed=!1},n.getPointAt=r,n.getAngleAt=l,n.clearPathsData=o,t.create=function(n,i){return new t(n,i)},t.defaultProps={text:"",fontSize:14,letterSpacing:0,offset:0,textAnchor:"start",side:"left",fontSrc:"",href:"",x:null,y:null,dx:0,dy:0,space:null,fontScale:"none"},u={textpath:"text","text-anchor":"textAnchor","font-size":"fontSize",letterspacing:"letterSpacing",side:"side",offset:"offset",x:"x",y:"y",dx:"dx",dy:"dy",xmlspace:"space","font-src":"fontSrc",href:"href","font-scale":"fontScale"},t.FontLoader=function(){var n=[],t={},i=function(t){for(var i=0,r=n.length;i<r;i++)if(n[i].url===t)return n[i];return null};return t.getFont=function(n,r){var u=i(n),f;if(u&&u.font){r(null,u.font);return}f=u?u.promise:t.loadFont(n);f.then(function(n){r(null,n)}).catch(function(n){r(n)})},t.loadFont=function(t){var r=i(t),u,f;return r?u=r.promise:(u=new Promise(function(n,i){opentype.load(t,function(t,r){if(t){i(t);return}n(r)})}),r={url:t,promise:u,font:null},f=n.push(r)-1,u.then(function(t){return n[f].font=t,t})),u},t}(),t}()