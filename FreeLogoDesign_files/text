Text=function(n,t,i,r,u,f,e,o,s){var h=this;h.width;h.height;h.oldwidth;h.oldheight;h.color=r.clone();h.format=new Textformat(n);h.format.font=t;h.textpath=null;h.drawningboard=u;h.group=h.drawningboard.workspace.g();h.path=h.group.path();h.textpath=new TextPath({text:n}).appendTo(h.group.node).render();h.svg=Snap(h.textpath.getElement());h.upperlayer=h.group.rect(0,0,0,0);h.path.attr("fill","none");h.group.attr("pointer-events","fill");h.x=f;h.y=e;h.realposition=!1;h.offset={x:0,y:0};h.scale=i?i:1;h.scalex=h.scale;h.scaley=h.scale;h.flipx=0;h.flipy=0;h.rotation=0;h.alpha=1;h.id=o;h.subid=s;h.groupid=0;h.statelist=[];h.curvedline={};h.curvedline.enabled=!1;h.curvedline.type="up";h.curvedline.start=!1;h.curvedline.x;h.curvedline.y;h.curvedline.left={};h.curvedline.left.x=0;h.curvedline.left.y=0;h.curvedline.anchorleft={};h.curvedline.anchorleft.x=0;h.curvedline.anchorleft.y=0;h.curvedline.anchorright={};h.curvedline.anchorright.x=0;h.curvedline.anchorright.y=0;h.curvedline.right={};h.curvedline.right.x=0;h.curvedline.right.y=0;h.curvedline.startwidth;h.curvedline.startheight;h.type="text";h.index;h.name;h.iconname;h.companytext=!1;h.letterspacing=0;h.start=function(){h.group.addClass("svg-text");h.realposition||(h.x=h.x?h.drawningboard.width/2+(h.x-h.offset.x/2)*h.scalex:h.drawningboard.width/2,h.y=h.y?h.drawningboard.height/2+(h.y-h.offset.y/2)*h.scaley:h.drawningboard.height/2);h.group.attr({cursor:"move"});h.curvedline.enabled||h.initcurvedata();h.index=h.drawningboard.selector.getnewindex(h.id,h.type);h.subid?(h.name=h.drawningboard.api.dictionary.element_text+" "+h.id+"."+h.subid,h.iconname=h.drawningboard.api.dictionary.element_logo+" "+h.id):h.name=h.drawningboard.api.dictionary.element_text+" "+h.id;h.updateFont(function(){h.update()});h.drawningboard.selector.watch(h)};h.initcurvedata=function(){var t=h.width||0,n=h.height||0;h.curvedline.left.x=-(t/2);h.curvedline.left.y=n-20;h.curvedline.anchorleft.x=-20;h.curvedline.anchorleft.y=n-21;h.curvedline.anchorright.x=20;h.curvedline.anchorright.y=n-21;h.curvedline.right.x=t/2;h.curvedline.right.y=n-20;h.curvedline.startwidth=t;h.curvedline.startheight=n+20};h.enabled=function(){return h.alpha};h.finish=function(){h.group.remove()};h.translateoffset=function(){var n={x:0,y:0};return n.y=h.height/2*h.scaley-h.height*h.flipy*h.scaley,n.x=h.curvedline.enabled?h.width/2*h.scalex-h.width*h.flipx*h.scalex:h.format.alignment=="center"?0:h.format.alignment=="left"?0:0,n};h.gettextsize=function(){var t=$(h.textpath.getElement()).parent()[0].getBBox(),n=h.textpath.font;return n?{width:h.textpath.getTextWidth(!0),height:Math.abs(n.ascender-n.descender)/n.unitsPerEm*h.format.size}:{width:t.width,height:t.height}};h.updateFont=function(n){h.textpath&&h.textpath.setProps({fontSrc:"/Content/clientfonts/"+h.format.getFontFileName()+".woff"}).render(n)};h.updatePath=function(){h.curvedline.enabled||h.initcurvedata();h.path.attr({d:"M"+h.curvedline.left.x+","+h.curvedline.left.y+" C"+h.curvedline.anchorleft.x+","+h.curvedline.anchorleft.y+" "+h.curvedline.anchorright.x+","+h.curvedline.anchorright.y+" "+h.curvedline.right.x+","+h.curvedline.right.y})};h.update=function(){var i,r,n,t;h.subid?(h.name=h.drawningboard.api.dictionary.element_text+" "+h.id+"."+h.subid,h.iconname=h.drawningboard.api.dictionary.element_logo+" "+h.id):h.name=h.drawningboard.api.dictionary.element_text+" "+h.id;i=h.svg.attr("fill");i&&i.id&&(r=$(h.drawningboard.workspace.node).find("#"+i.id),r.length==1&&r.remove());n={text:h.format.text,fontScale:"contain",fontSize:h.format.size,textAnchor:"middle",space:"preserve",side:h.curvedline.type==="up"?"left":"right",letterSpacing:h.format.letterspacing||0};h.curvedline.enabled?(n.dy=0,n.x=0,n.y=0,n.offset=.5):n.offset=0;h.updatePath();h.textpath&&h.textpath.setPath(h.curvedline.enabled?h.path.node:null);h.curvedline.enabled||(n.side="left");n.dy=h.curvedline.enabled?0:(h.height||0)*.75;t=h._textsize;(h.textpath.changed||h.textpath.props.text!==n.text||!h._textsize)&&h.textpath.setProps(n).render(function(){t=h._textsize=h.gettextsize();h.textpath.setProps({dy:t.height*.75})});t=h._textsize=h.gettextsize();h.curvedline.enabled||(h.oldWidth=h.width,h.oldHeight=h.height,h.width=t.width,h.height=t.height,h.updatePath(),h.upperlayer.attr({width:0,height:0}),h.oldWidth!=h.width&&(h.format.alignment=="left"?h.x-=(h.oldWidth-h.width)*h.scalex/2:h.format.alignment=="right"&&(h.x+=(h.oldWidth-h.width)*h.scalex/2)));h.group.attr({transform:"translate("+parseInt(h.x-h.translateoffset().x)+","+parseInt(h.y-h.translateoffset().y)+") rotate("+parseInt(calc.fixDegree(h.rotation))+" "+h.translateoffset().x+" "+h.translateoffset().y+") scale("+h.scalex*(h.flipx?-1:1)+","+h.scaley*(h.flipy?-1:1)+")",opacity:h.alpha});h.alpha?(h.group.addClass("svg-visible"),h.group.removeClass("svg-hidden")):(h.group.removeClass("svg-visible"),h.group.addClass("svg-hidden"));h.textpath.setProps(n).render();h.svg.attr({fill:h.color.getsvgcolor(h.drawningboard.workspace)})}}