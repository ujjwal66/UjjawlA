Contexttab=function(n){var i=1e3,t=this;t.dom;t.drawningboard=n;t.unselecteddom;t.carousel;t.holdinterval;t.radialing=!1;t.fontliststate;t.fontlistmouse=!0;t.selectboxstate;t.originalfont;t.textpanel;t.shapepanel;t.unselectpanel;t.currentpanel;t.emptytext;t.color;t.originalcolor;t.canBold=!1;t.canItalic=!1;t.clear=!1;t.start=function(){function n(n){n.stopPropagation()}t.dom=$("#contexttab");t.carousel=t.dom.find(".carousel");t.eventtype="touchstart mousedown";t.eventleavetype="touchend mouseup mouseout";t.textpanel=t.dom.find(".carousel .text");t.shapepanel=t.dom.find(".carousel .shape");t.unselectpanel=t.dom.find(".carousel .unselected");t.carousel.owlCarousel({items:1,itemsTablet:[1920,1],itemsMobile:[1920,1],touchDrag:!1,mouseDrag:!1,pagination:!1});t.dom.hide();t.carousel.trigger("owl.goTo",1);t.dom.slideDown(200);t.dom.nodoubletapzoom();t.drawningboard.formatsvg(t.dom);t.registerevents();var i=t.dom.find(".textbox input");i.off("mouseup mousemove",n);i.on("mouseup mousemove",n)};t.finish=function(){t.carousel.data("owlCarousel").destroy();t.dom.empty()};t.loadfonts=function(){var i=t.dom.find(".fontlist .wrapper"),n,u,r;i.empty();$.each(t.drawningboard.fontlist,function(n,t){i.append($('<div name="'+t.name+'" italic="'+t.italic+'" bold="'+t.bold+'" style="font-family: '+t.name+';">'+t.name+"<\/div>"))});n=t.dom.find(".fontbox .fontlist");i.find("div").on("click",function(i){i.preventDefault?i.preventDefault():i.returnValue=!1;t.target.format.font=$(this).css("font-family").replace(/"/g,"");t.originalfont=t.target.format.font;t.target.update();t.drawningboard.selector.changed=1;t.drawningboard.selector.save();t.drawningboard.selector.gettargetdata();t.drawningboard.selector.update();t.updatepreview();t.setselectedfont(t.target.format.font);n.hide();t.fontliststate=!1});if(!t.drawningboard.isTouch)i.find("div").on("mouseover",function(){t.fontlistmouse&&t.selectfontlistitem($(this))});u=t.dom.find(".fontbox .arrow-td");r=t.dom.find(".fontbox .selected-font");r.add(u).unbind(t.eventtype).on(t.eventtype,function(i){if(i.preventDefault(),t.fontliststate)n.hide(),t.fontliststate=!1,t.target.format.font=t.originalfont,t.target.update(),t.drawningboard.selector.gettargetdata(),t.drawningboard.selector.update(),t.updatepreview();else if(t.drawningboard.fontsloaded){t.originalfont=t.target.format.font;n.show();t.fontliststate=!0;var u=n.find(".wrapper div:contains('"+r.text()+"')");t.selectfontlistitem(u)}else t.drawningboard.loadfonts(undefined,function(){t.loadfonts();t.originalfont=t.target.format.font;n.show();t.fontliststate=!0;var i=n.find(".wrapper div:contains('"+r.text()+"')");t.selectfontlistitem(i)})})};t.unselect=function(){t.dom.find(".multiple").hide();t.dom.find(".single").show();t.dom.find(".multiple .direction-custom .spinner").val("0°");t.dom.find(".preview").empty();t.dom.find(".fontbox .fontlist").hide();t.dom.find(".selectbox .selectorlist").hide();t.fontliststate=!1;t.selectboxstate=!1;t.fontlistmouse=!0;t.target&&t.target.format&&t.fontliststate&&(t.target.format.font=t.originalfont);t.dom.find(".textbox input").is(":focus")&&t.dom.find(".textbox input").blur();t.dom.find(".direction-custom .spinner").is(":focus")&&t.dom.find(".direction-custom .spinner").blur();t.dom.find(".curved-text .command-action").removeClass("active");t.dom.find(".selectbox .selector").empty()};t.select=function(n){setTimeout(function(){t.clear||t.unselect();n instanceof Array?(t.clear=!1,n.length==1?n[0]instanceof Text?t.textselection(n[0]):n[0]instanceof Clip&&t.shapeselection(n[0]):t.multiselection(n),t.updatepreview()):(t.clear||t.unselection(),t.clear=!0)},1)};t.unselection=function(){t.currentpanel=t.unselectpanel;t.dom.find(".unselected .commandbox").slideUp("fast");t.dom.find(".unselected .colorbox.picker").hide();t.dom.find(".unselected .colorbox.multipicker").show();t.dom.find(".selectoriconlist").hide();t.dom.find(".noselection-options").show();t.startcolormultipicker();t.carousel.trigger("owl.goTo",1)};t.multiselection=function(n){if(t.target=n,t.currentpanel=t.unselectpanel,t.target.length){var i=!0;$.each(t.target,function(n,r){t.target[0].color.compare(r.color)||(i=!1)});i?t.startcolorselection(t.target[0].color):t.startcolorselection(undefined);t.carousel.trigger("owl.goTo",1)}else t.startcolorselection(undefined);t.dom.find(".unselected .commandbox").stop().slideDown("fast");t.dom.find(".unselected .colorbox.picker").show();t.dom.find(".unselected .colorbox.multipicker").hide();t.drawningboard.ownermode&&t.drawningboard.selector.targethavecompanytext()?(t.unselectpanel.find(".commandbox .commands .rotate .command-action").addClass("disabled"),t.unselectpanel.find(".commandbox .commands .flip .command-action").addClass("disabled"),t.unselectpanel.find(".commandbox .commands .delete .command-action").addClass("disabled")):(t.unselectpanel.find(".commandbox .commands .rotate .command-action").removeClass("disabled"),t.unselectpanel.find(".commandbox .commands .flip .command-action").removeClass("disabled"),t.unselectpanel.find(".commandbox .commands .delete .command-action").removeClass("disabled"))};t.shapeselection=function(n){t.target=n;t.currentpanel=t.shapepanel;t.startcolorselection(t.target.color);setTimeout(function(){t.carousel.trigger("owl.goTo",0)},15)};t.textselection=function(n){t.target=n;t.loadfonts();t.currentpanel=t.textpanel;t.startcolorselection(t.target.color);t.starttextformatselection(t.target.format);setTimeout(function(){t.carousel.trigger("owl.goTo",2)},15);t.drawningboard.ownermode&&t.drawningboard.selector.targethavecompanytext()?(t.textpanel.find(".top-controls .textbox input").attr("readonly","readonly"),t.textpanel.find(".top-controls .textbox input").addClass("disabled"),t.textpanel.find(".commandbox .commands .rotate .command-action").addClass("disabled"),t.textpanel.find(".commandbox .commands .flip .command-action").addClass("disabled"),t.textpanel.find(".commandbox .commands .delete .command-action").addClass("disabled"),t.textpanel.find(".commandbox .commands .group .command-action").addClass("disabled"),t.textpanel.find(".reshape-item").hide()):(t.textpanel.find(".top-controls .textbox input").removeAttr("readonly"),t.textpanel.find(".top-controls .textbox input").removeClass("disabled"),t.textpanel.find(".commandbox .commands .rotate .command-action").removeClass("disabled"),t.textpanel.find(".commandbox .commands .flip .command-action").removeClass("disabled"),t.textpanel.find(".commandbox .commands .delete .command-action").removeClass("disabled"),t.textpanel.find(".commandbox .commands .group .command-action").removeClass("disabled"),t.textpanel.find(".reshape-item").show())};t.updatepreview=function(){var n,o,a,f,s,k,v,y,i,c,r,p;if(t.target instanceof Array)t.drawningboard.selector.targetisicon()?(n=t.dom.find(".selectbox .selector"),n.empty(),n.append($("<svg id='selectorframe'><\/svg><div class='selectorname'>"+t.target[0].iconname+"<\/div>")),r=Snap("#selectorframe"),i=t.drawningboard.selector.getclipdata(t.target),$.each(t.target,function(n,t){var u=Snap(t.group.node.cloneNode(!0));u.attr({transform:"none",cursor:"pointer"});u.attr({transform:"translate("+parseFloat(t.x-i.x1-t.translateoffset().x)+","+parseFloat(t.y-i.y1-t.translateoffset().y)+") rotate("+parseInt(calc.fixDegree(t.rotation))+" "+t.translateoffset().x+" "+t.translateoffset().y+") scale("+t.scalex*(parseFloat(t.flipx)?-1:1)+","+t.scaley*(parseFloat(t.flipy)?-1:1)+")"});r.add(u)}),r.attr({viewBox:"0,0,"+i.width+","+i.height}),n.find("svg").css("width","50px"),n.find("svg").css("height","26px"),n.find("svg").css("margin-left","5px"),t.loadiconelements()):t.loadiconelements();else{var e=t.currentpanel.find(".preview"),n=t.dom.find(".selectbox .selector"),l=t.target instanceof Text;if(t.dom.find(".selectoriconlist").hide(),e.empty(),n.empty(),o=t.target.svg.attr("fill"),a=o&&o.node?o.node.cloneNode(!0):null,l)var w={fontSize:100,fill:o,fontFamily:t.target.format.font},f=Snap().text(0,0,t.target.textpath.props.text).attr(w),s=Snap().text(0,0,t.target.textpath.props.text).attr(w);else f=Snap(t.target.group.node.cloneNode(!0)),s=Snap(t.target.group.node.cloneNode(!0));f.attr({transform:"none",cursor:"pointer"});s.attr({transform:"none",cursor:"pointer"});var u=t.target,h=f.getBBox(),d=l?u.textpath.getTextWidth():h.width,b;l?(b=u.curvedline&&u.curvedline.enabled||!u.textpath.font?h.height:Math.abs(u.textpath.font.descender-u.textpath.font.ascender)/u.textpath.font.unitsPerEm*u.textpath.props.fontSize,k=0,v=["translate(0,",k,")"].join(""),s.attr({transform:v}),f.attr({transform:v})):(y=[],y.push(t.target),i=t.drawningboard.selector.getclipdata(y),f.attr({transform:"translate("+parseFloat(t.target.x-i.x1-t.target.translateoffset().x)+","+parseFloat(t.target.y-i.y1-t.target.translateoffset().y)+") rotate("+parseInt(calc.fixDegree(t.target.rotation))+" "+t.target.translateoffset().x+" "+t.target.translateoffset().y+") scale("+t.target.scalex*(parseFloat(t.target.flipx)?-1:1)+","+t.target.scaley*(parseFloat(t.target.flipy)?-1:1)+")"}));e.append($("<svg id='previewframe'><\/svg>"));n.append($("<svg id='selectorframe'><\/svg><div class='selectorname'>"+t.target.name+"<\/div>"));c=Snap("#previewframe");r=Snap("#selectorframe");t.target instanceof Text?(p={viewBox:h.x+","+h.y+","+d+","+b},r.attr(p),c.attr(p)):(r.attr({viewBox:"0,0,"+i.width+","+i.height}),c.attr({viewBox:"0,0,"+t.target.width+","+t.target.height}));c.add(s);r.add(f);e.find("svg").css("width","100%");e.find("svg").css("height","100%");n.find("svg").css("width","50px");n.find("svg").css("height","26p");n.find("svg").css("margin-left","5px");a&&e.find("svg").find("defs").append(a)}};t.starttextformatselection=function(n){var r,u,f,i;n.font===undefined&&(n.font=Textformat.defaultFont);n.font=n.font.replace(/\"/g,"");r=t.currentpanel.find(".textbox input");r.val(n.text);r.attr("original",n.text);u=t.currentpanel.find(".fontbox .bold");n.bold?u.addClass("active"):u.removeClass("active");f=t.currentpanel.find(".fontbox .italic");n.italic?f.addClass("active"):f.removeClass("active");t.setselectedfont(n.font);t.target.curvedline.enabled&&(t.target.curvedline.type=="up"?t.dom.find(".reshape-action-up").addClass("active"):t.dom.find(".reshape-action-down").addClass("active"));t.dom.find(".align-text .command-action").removeClass("active");t.target.format.alignment?t.target.format.alignment=="left"?t.dom.find(".align-action-left").addClass("active"):t.target.format.alignment=="center"?t.dom.find(".align-action-center").addClass("active"):t.target.format.alignment=="right"&&t.dom.find(".align-action-right").addClass("active"):t.dom.find(".align-action-center").addClass("active");i=t.target.format.letterspacing;isNaN(i)||(t.textpanel.find(".letterspacing-slider").slider("value",i),t.textpanel.find(".letterspacing input").val(i))};t.setselectedfont=function(n){var r,i,u;t.originalfont=t.target.format.font;r=t.currentpanel.find(".fontbox .selected-font");i=n;i.indexOf(",")>=0&&(i=i.substring(0,i.lastIndexOf(",")));i=i.replace("'","").replace("'","");u=t.currentpanel.find(".fontlist .wrapper div[name='"+i+"']");t.selectfontlistitem(u,!0);r.html($("<div style='font-size:15px;'>"+i+"<\/div>"));r.find("div").css("font-family",n)};t.focustextinput=function(){var n=t.currentpanel.find(".textbox input");n.focus();n.select()};t.undo=function(){t.startcolormultipicker()};t.redo=function(){t.startcolormultipicker()};t.startcolormultipicker=function(){var i=!1,n;if($.each(t.drawningboard.cliplist,function(n,t){t.enabled()&&(i=!0)}),!i){t.dom.find(".colorbox.multipicker").hide();return}t.dom.find(".colorbox.multipicker .color-picker").remove();$("body").find(".colpick").not("#colorpicker_bg").not("#colorpicker_dominant").remove();n=[];$.each(t.drawningboard.cliplist,function(i,r){r.enabled()&&$.each(r.color.colorlist,function(i,r){var u=!1;$.each(n,function(n,t){r.color==t&&(u=!0)});u||(n.push(r.color),cbx=new Maincolorbox(t,t.currentpanel.find(".colorbox.multipicker .contents"),new Color(r.color)),cbx.start())})})};t.startcolorselection=function(n){if(t.dom.find(".colorbox.picker .color-picker").remove(),$("body").find(".colpick").not("#colorpicker_bg").not("#colorpicker_dominant").remove(),n?t.color=n.clone():(t.color=new Gradient,t.color.colorlist.push(new Color(undefined))),t.originalcolor=t.color.clone(),t.color.colorlist.length==1)cbx=new Colorbox(t,t.currentpanel.find(".colorbox.picker .single"),t.color.colorlist[0]),cbx.start();else{t.currentpanel.find(".colorbox.picker .multiple").slideDown("fast");t.currentpanel.find(".colorbox.picker .single").hide();var i=t.currentpanel.find(".colorbox.picker .multiple-track"),r=t.currentpanel.find(".colorbox.picker .direction-custom input");$.each(t.color.colorlist,function(n,r){setTimeout(function(){var n=new Colorbox(t,i,r,!0);n.start()},0)});r.val(t.color.rotation+"°")}};t.updatespinvalue=function(n){t.drawningboard.selector.closecontext();t.currentpanel.find(".direction-custom .spinner").dgspinner().val(n+"°");t.dom.find(".multiple .radar").css("-webkit-transform","rotate("+n+"deg)");t.color.rotation=n;t.updatecolor();t.updatepreview();t.drawningboard.selector.changed=1;t.drawningboard.selector.save();t.drawningboard.selector.refreshindex()};t.loadiconelements=function(){var n=t.dom.find(".selectoriconlist .wrapper"),u=t.dom.find(".selectoriconlist"),i,r;n.empty();t.dom.find(".noselection-options").hide();i=[];$.each(t.target,function(r,u){var e,f,h,o,s;u.enabled()&&(u.subid==undefined?(e=u.name.replace(" ","").replace(".","-"),n.append($("<div class='listitem' clipname='"+u.name+"' clipiconname='"+u.iconname+"'><svg id='svglisticonitem"+e+"'><\/svg><span>"+u.name+"<\/span><\/div>")),f=u instanceof Text?Snap(u.svg.node.cloneNode(!0)):Snap(u.group.node.cloneNode(!0)),f.attr({cursor:"pointer",transform:"none"}),u instanceof Text?(f.attr({textpath:"","text-anchor":"start",dy:"1em"}),f.node.textContent=u.format.text):(h=[],h.push(u),o=t.drawningboard.selector.getclipdata(h),f.attr({transform:"translate("+parseFloat(u.x-o.x1-u.translateoffset().x)+","+parseFloat(u.y-o.y1-u.translateoffset().y)+") rotate("+parseInt(calc.fixDegree(u.rotation))+" "+u.translateoffset().x+" "+u.translateoffset().y+") scale("+u.scalex*(parseFloat(u.flipx)?-1:1)+","+u.scaley*(parseFloat(u.flipy)?-1:1)+")"})),s=Snap("#svglisticonitem"+e),u instanceof Text?s.attr({viewBox:"0,0,"+u.curvedline.startwidth+","+u.curvedline.startheight}):s.attr({viewBox:"0,0,"+o.width+","+o.height}),$("#svglisticonitem"+e).css("width","50px"),$("#svglisticonitem"+e).css("height","26px"),$("#svglisticonitem"+e).css("margin-left","5px"),s.add(f)):i.push(u))});$.each(i,function(u,f){var e,c,s,o,h;f.iconname!=r&&(r=f.iconname,s=[],e=f.name.replace(" ","").replace(".","-"),n.append($("<div class='listitem' clipname='"+f.iconname+"' clipiconname='"+f.iconname+"'><svg id='svglisticonitemicon"+e+"'><\/svg><span>"+f.iconname+"<\/span><\/div>")),h=Snap("#svglisticonitemicon"+e),$.each(i,function(n,t){t.iconname==r&&s.push(t)}),o=t.drawningboard.selector.getclipdata(s),h.attr({viewBox:"0,0,"+o.width+","+o.height}),$("#svglisticonitemicon"+e).css("width","50px"),$("#svglisticonitemicon"+e).css("height","26px"),$("#svglisticonitemicon"+e).css("margin-left","5px"),$.each(s,function(n,t){var i=Snap(t.group.node.cloneNode(!0));i.attr({transform:"none",cursor:"pointer"});i.attr({transform:"translate("+parseFloat(t.x-o.x1-t.translateoffset().x)+","+parseFloat(t.y-o.y1-t.translateoffset().y)+") rotate("+parseInt(calc.fixDegree(t.rotation))+" "+t.translateoffset().x+" "+t.translateoffset().y+") scale("+t.scalex*(parseFloat(t.flipx)?-1:1)+","+t.scaley*(parseFloat(t.flipy)?-1:1)+")"});h.add(i)}));e=f.name.replace(" ","").replace(".","-");n.append($("<div class='listitem' clipname='"+f.name+"' clipiconname='"+f.iconname+"''><svg id='svglisticonitem"+e+"'><\/svg><span>"+f.name+"<\/span><\/div>"));c=Snap(f.group.node.cloneNode(!0));c.attr({transform:"none",cursor:"pointer"});s=[];s.push(f);o=t.drawningboard.selector.getclipdata(s);c.attr({transform:"translate("+parseFloat(f.x-o.x1-f.translateoffset().x)+","+parseFloat(f.y-o.y1-f.translateoffset().y)+") rotate("+parseInt(calc.fixDegree(f.rotation))+" "+f.translateoffset().x+" "+f.translateoffset().y+") scale("+f.scalex*(parseFloat(f.flipx)?-1:1)+","+f.scaley*(parseFloat(f.flipy)?-1:1)+")"});h=Snap("#svglisticonitem"+e);h.attr({viewBox:"0,0,"+o.width+","+o.height});$("#svglisticonitem"+e).css("width","50px");$("#svglisticonitem"+e).css("height","26px");$("#svglisticonitem"+e).css("margin-left","30px");h.add(c)});t.dom.find(".selectoriconlist .wrapper div").on("mouseover",function(){var n=$(this),i;n.attr("clipname")==n.attr("clipiconname")?(i=[],$.each(t.drawningboard.cliplist,function(t,r){r.iconname==n.attr("clipiconname")&&r.enabled()&&i.push(r)}),t.drawningboard.selector.highlight(i)):$.each(t.drawningboard.cliplist,function(i,r){if(r.name==n.attr("clipname")&&r.enabled()){if(n.attr("clipiconname")!="undefined"){t.drawningboard.selector.highlight([r]);return}t.drawningboard.selector.highlight([r])}})});t.dom.find(".selectoriconlist .wrapper div").on("mouseleave",function(){t.drawningboard.selector.unhighlight()});t.dom.find(".selectoriconlist .wrapper").find("div").on("click",function(n){var i,r;n.preventDefault?n.preventDefault():n.returnValue=!1;t.dom.find(".selectbox .selectorlist").hide();t.selectboxstate=!1;i=$(this);i.attr("clipname")==i.attr("clipiconname")?(r=[],t.drawningboard.selector.explodedmode&&t.drawningboard.selector.endexplodedmode(),$.each(t.drawningboard.cliplist,function(n,t){t.iconname==i.attr("clipiconname")&&t.enabled()&&r.push(t)}),t.drawningboard.selector.select(r,!0)):$.each(t.drawningboard.cliplist,function(n,r){if(r.name==i.attr("clipname")&&r.enabled()){if(i.attr("clipiconname")!="undefined"){t.drawningboard.selector.startexplodedmode(r);return}t.drawningboard.selector.select([r],!0);t.drawningboard.selector.explodedmode&&t.drawningboard.selector.endexplodedmode()}})});u.show()};t.loadselectlist=function(){var i=t.dom.find(".selectbox .selectorlist .wrapper"),n,r;i.empty();n=[];t.drawningboard.cliplist.sort(t.drawningboard.selector.compareclip);$.each(t.drawningboard.cliplist,function(r,u){var e,f,h,o,s;u.enabled()&&(u.subid==undefined?(e=u.name.replace(" ","").replace(".","-"),i.append($("<div class='listitem' clipname='"+u.name+"' clipiconname='"+u.iconname+"''><svg id='svglistitem"+e+"'><\/svg><span>"+u.name+"<\/span><\/div>")),f=u instanceof Text?Snap(u.svg.node.cloneNode(!0)):Snap(u.group.node.cloneNode(!0)),f.attr({transform:"none",cursor:"pointer"}),u instanceof Text?(f.attr({textpath:"","text-anchor":"start",dy:"1em"}),f.node.textContent=u.format.text):(h=[],h.push(u),o=t.drawningboard.selector.getclipdata(h),f.attr({transform:"translate("+parseFloat(u.x-o.x1-u.translateoffset().x)+","+parseFloat(u.y-o.y1-u.translateoffset().y)+") rotate("+parseInt(calc.fixDegree(u.rotation))+" "+u.translateoffset().x+" "+u.translateoffset().y+") scale("+u.scalex*(parseFloat(u.flipx)?-1:1)+","+u.scaley*(parseFloat(u.flipy)?-1:1)+")"})),s=Snap("#svglistitem"+e),u instanceof Text?s.attr({viewBox:"0,0,"+u.curvedline.startwidth+","+u.curvedline.startheight}):s.attr({viewBox:"0,0,"+o.width+","+o.height}),$("#svglistitem"+e).css("width","50px"),$("#svglistitem"+e).css("height","26px"),$("#svglistitem"+e).css("margin-left","5px"),s.add(f)):n.push(u))});n.sort(t.drawningboard.selector.compareclip);$.each(n,function(u,f){var e,c,h,s,o;f.iconname!=r&&(r=f.iconname,e=f.name.replace(" ","").replace(".","-"),i.append($("<div class='listitem' clipname='"+f.iconname+"' clipiconname='"+f.iconname+"''><svg id='svglistitemicon"+e+"'><\/svg><span>"+f.iconname+"<\/span><\/div>")),h=Snap("#svglistitemicon"+e),s=[],$.each(n,function(n,t){t.iconname==r&&s.push(t)}),o=t.drawningboard.selector.getclipdata(s),h.attr({viewBox:"0,0,"+o.width+","+o.height}),$.each(s,function(n,t){var i=Snap(t.group.node.cloneNode(!0));i.attr({transform:"none",cursor:"pointer"});i.attr({transform:"translate("+parseFloat(t.x-o.x1-t.translateoffset().x)+","+parseFloat(t.y-o.y1-t.translateoffset().y)+") rotate("+parseInt(calc.fixDegree(t.rotation))+" "+t.translateoffset().x+" "+t.translateoffset().y+") scale("+t.scalex*(parseFloat(t.flipx)?-1:1)+","+t.scaley*(parseFloat(t.flipy)?-1:1)+")"});h.add(i)}),$("#svglistitemicon"+e).css("width","50px"),$("#svglistitemicon"+e).css("height","26px"),$("#svglistitemicon"+e).css("margin-left","5px"));e=f.name.replace(" ","").replace(".","-");i.append($("<div class='listitem' clipname='"+f.name+"' clipiconname='"+f.iconname+"''><svg id='svglistitem"+e+"'><\/svg><span>"+f.name+"<\/span><\/div>"));c=Snap(f.group.node.cloneNode(!0));c.attr({transform:"none",cursor:"pointer"});h=Snap("#svglistitem"+e);s=[];s.push(f);o=t.drawningboard.selector.getclipdata(s);c.attr({transform:"translate("+parseFloat(f.x-o.x1-f.translateoffset().x)+","+parseFloat(f.y-o.y1-f.translateoffset().y)+") rotate("+parseInt(calc.fixDegree(f.rotation))+" "+f.translateoffset().x+" "+f.translateoffset().y+") scale("+f.scalex*(parseFloat(f.flipx)?-1:1)+","+f.scaley*(parseFloat(f.flipy)?-1:1)+")"});h.attr({viewBox:"0,0,"+o.width+","+o.height});$("#svglistitem"+e).css("width","50px");$("#svglistitem"+e).css("height","26px");$("#svglistitem"+e).css("margin-left","30px");h.add(c)});t.dom.find(".selectbox .selectorlist .wrapper").find("div").on("mouseenter",function(){var n=$(this),i;n.attr("clipname")==n.attr("clipiconname")?(i=[],$.each(t.drawningboard.cliplist,function(t,r){r.iconname==n.attr("clipiconname")&&r.enabled()&&i.push(r)}),t.drawningboard.selector.highlight(i)):$.each(t.drawningboard.cliplist,function(i,r){if(r.name==n.attr("clipname")&&r.enabled()){if(n.attr("clipiconname")!="undefined"){t.drawningboard.selector.highlight([r]);return}t.drawningboard.selector.highlight([r])}})});t.dom.find(".selectbox .selectorlist .wrapper").find("div").on("mouseleave",function(){t.drawningboard.selector.unhighlight()});t.dom.find(".selectbox .selectorlist .wrapper").find("div").on("click",function(n){var i,r;n.preventDefault?n.preventDefault():n.returnValue=!1;t.dom.find(".selectbox .selectorlist").hide();t.selectboxstate=!1;i=$(this);i.attr("clipname")==i.attr("clipiconname")?(r=[],t.drawningboard.selector.explodedmode&&t.drawningboard.selector.endexplodedmode(),$.each(t.drawningboard.cliplist,function(n,t){t.iconname==i.attr("clipiconname")&&t.enabled()&&r.push(t)}),t.drawningboard.selector.select(r,!0)):$.each(t.drawningboard.cliplist,function(n,r){if(r.name==i.attr("clipname")&&r.enabled()){if(i.attr("clipiconname")!="undefined"){t.drawningboard.selector.startexplodedmode(r);return}t.drawningboard.selector.select([r],!0);t.drawningboard.selector.explodedmode&&t.drawningboard.selector.endexplodedmode()}})})};t.fontup=function(){t.drawningboard.selector.closecontext();t.fontlistmouse=!1;var i=t.dom.find(".fontbox .fontlist"),r=i.find(".wrapper div.selected"),n=r[0].previousElementSibling;n&&t.selectfontlistitem(n)};t.fontdown=function(){t.drawningboard.selector.closecontext();t.fontlistmouse=!1;var i=t.dom.find(".fontbox .fontlist"),r=i.find(".wrapper div.selected"),n=r[0].nextElementSibling;n&&t.selectfontlistitem(n)};t.selectfontlistitem=function(n,i){var u,r,f;t.drawningboard.selector.closecontext();u=t.dom.find(".fontbox .fontlist");u.find(".wrapper div").removeClass("selected");r=$(n);f=t.target.format.getFontFileName();r.addClass("selected");r.attr("tabindex","-1");r.focus();r.removeAttr("tabindex");i||(t.currentpanel.find(".fontbox .bold").removeClass("active"),t.currentpanel.find(".fontbox .italic").removeClass("active"),t.target.format.bold=!1,t.target.format.italic=!1);r.attr("italic")=="0"?(t.currentpanel.find(".fontbox .italic").addClass("disabled"),t.canItalic=!1):(t.currentpanel.find(".fontbox .italic").removeClass("disabled"),t.canItalic=!0);r.attr("bold")=="0"?(t.currentpanel.find(".fontbox .bold").addClass("disabled"),t.canBold=!1):(t.currentpanel.find(".fontbox .bold").removeClass("disabled"),t.canBold=!0);t.target.format.font=r.css("font-family");t.updateTargetFont()};t.updateTargetFont=function(){t.target.updateFont(function(){t.target.update();t.drawningboard.selector.gettargetdata();t.drawningboard.selector.update();t.updatepreview()})};t.fontenter=function(){t.drawningboard.selector.closecontext();var n=t.dom.find(".fontbox .fontlist"),i=n.find(".wrapper div.selected");i.trigger("click")};t.updatealignment=function(n){t.drawningboard.selector.closecontext();t.target.format.alignment!=n&&(t.target.format.alignment=n,t.target.update())};t.registerevents=function(){var n,r,o,s,h,u,f,e;t.textpanel.on("touchmove",function(n){$(n.target).parents(".owl-item")[0]||n.preventDefault()});t.unselectpanel.find(".addtext").on(t.eventtype,function(n){n.preventDefault();t.drawningboard.toolbar.addtext()});t.unselectpanel.find(".addshape").on(t.eventtype,function(n){n.preventDefault();t.drawningboard.toolbar.addshape()});t.unselectpanel.find(".addlogo").on(t.eventtype,function(n){n.preventDefault();t.drawningboard.toolbar.addlogo()});t.unselectpanel.find(".addicon").on(t.eventtype,function(n){n.preventDefault();t.drawningboard.toolbar.addicon()});t.unselectpanel.find(".addsvg").on(t.eventtype,function(n){n.preventDefault();t.drawningboard.toolbar.addsvg()});t.unselectpanel.find(".reviewlogo").on(t.eventtype,function(n){n.preventDefault();t.drawningboard.toolbar.reviewicon()});t.dom.find(".multiple .color-add").on(t.eventtype,function(n){var i,r,u;n.preventDefault();t.color.colorlist.length<10?(i=new Color(t.color.colorlist[0].color),i.position=50,t.color.colorlist.push(i),r=new Colorbox(t,t.currentpanel.find(".multiple-track"),i,!0),r.autoopen=!0,r.event=n,r.start(),t.drawningboard.selector.refreshindex()):(u=new Messagebox(t.drawningboard,t.drawningboard.api.dictionary.contexttab_color_limit,null,null,t.drawningboard.api.dictionary.ok),u.show())});t.dom.find(".single .color-add").on(t.eventtype,function(n){var u,i,r;n.preventDefault();t.currentpanel.find(".multiple").slideDown(300);t.currentpanel.find(".single").hide();t.currentpanel.find(".single .color-picker").remove();t.color.colorlist[0].position=0;t.color.colorlist[0].color||(t.color.colorlist[0].color="rgba(0, 0, 0, 1)");u=new Colorbox(t,t.currentpanel.find(".multiple-track"),t.color.colorlist[0],!0);u.start();i=new Color(t.color.colorlist[0].color);i.position=100;t.color.colorlist.push(i);r=new Colorbox(t,t.currentpanel.find(".multiple-track"),i,!0);r.autoopen=!0;r.start();t.drawningboard.selector.refreshindex()});$.widget("ui.dgspinner",$.ui.spinner,{options:{step:1,spin:function(n,i){if(t.color.type=="radial"||i.value>=360)return $(this).dgspinner("value",0),!1;if(i.value<0)return $(this).dgspinner("value",359),!1;t.color.rotation=i.value;t.updatecolor();t.updatepreview()},change:function(){parseInt($(this).val())<0?$(this).val("0°"):parseInt($(this).val())>=360?$(this).val("0°"):isNaN(parseInt($(this).val()))&&$(this).val("0°")}},_parse:function(n){return parseFloat(n)},_format:function(n){return n+"°"}});n=t.dom.find(".multiple .direction-custom .spinner");n.dgspinner().val("0°");n.on("blur",function(){t.drawningboard.selector.closecontext();var n=t.currentpanel.find(".multiple .direction-custom .spinner");parseInt(n.val())!=0&&t.updatespinvalue(parseInt(n.val()))});n.keyup(function(n){if(n.keyCode==13){var i=t.currentpanel.find(".multiple .direction-custom .spinner");t.updatespinvalue(parseInt(i.val()))}});n.mouseup(function(n){return n.preventDefault(),!1});n.on("focus",function(){t.drawningboard.selector.closecontext();t.drawningboard.isIOS||t.drawningboard.isSafari?this.setSelectionRange(0,9999):n.select()});r=t.dom.find(".textbox input");r.on("keyup",function(n){var i,r,u;t.drawningboard.selector.closecontext();i=t.currentpanel.find(".textbox input");r=i.val();r==""?(r="ˆ",t.emptytext||(t.originalcolor=t.target.color.clone()),t.emptytext=!0,t.drawningboard.selector.displaycontrols=!1,t.drawningboard.selector.updateselector(),u=new Gradient,u.colorlist.push(new Color("rgba(255,255,255,0)")),t.target.color=u):(t.emptytext&&(t.target.color=t.originalcolor,t.drawningboard.selector.displaycontrols=!0),t.emptytext=!1);t.target.format.text=r;t.target.update();i.val()==i.attr("original")||t.emptytext||(t.drawningboard.selector.changed=1,t.drawningboard.selector.save(),i.attr("original",i.val()));t.drawningboard.selector.gettargetdata();t.drawningboard.selector.update();t.updatepreview();n.keyCode==13&&i.blur()});r.on("paste",function(){t.drawningboard.selector.closecontext();setTimeout(function(){var n=t.currentpanel.find(".textbox input"),i=n.val();t.emptytext&&(t.target.color=t.originalcolor,t.emptytext=!1,t.drawningboard.selector.displaycontrols=!0);t.target.format.text=i;t.target.update();n.val()!=n.attr("original")&&(t.drawningboard.selector.changed=1,t.drawningboard.selector.save(),n.attr("original",n.val()));t.drawningboard.selector.gettargetdata();t.drawningboard.selector.update();t.updatepreview()},100)});r.on("blur",function(){t.drawningboard.selector.closecontext();t.emptytext&&(t.target.format.text="New Text",t.target.color=t.originalcolor,t.target.update(),t.drawningboard.selector.displaycontrols=!0,t.drawningboard.selector.changed=1,t.drawningboard.selector.save(),t.drawningboard.selector.gettargetdata(),t.drawningboard.selector.update(),t.updatepreview());var n=t.currentpanel.find(".textbox input");n.val(t.target.format.text)});o=t.dom.find(".fontbox .bold");s=t.dom.find(".fontbox .italic");o.on(t.eventtype,function(n){if(n.preventDefault(),t.drawningboard.selector.closecontext(),t.canBold){var i=t.currentpanel.find(".fontbox .bold");t.target.format.bold?(t.target.format.bold=!1,i.removeClass("active")):(t.target.format.bold=!0,i.addClass("active"));t.updateTargetFont();t.drawningboard.selector.changed=1;t.drawningboard.selector.save()}});s.on(t.eventtype,function(n){if(n.preventDefault(),t.drawningboard.selector.closecontext(),t.canItalic){var i=t.currentpanel.find(".fontbox .italic");t.target.format.italic?(t.target.format.italic=!1,i.removeClass("active")):(t.target.format.italic=!0,i.addClass("active"));t.updateTargetFont();t.drawningboard.selector.changed=1;t.drawningboard.selector.save()}});h=t.dom.find(".selectbox table");u=t.dom.find(".selectbox .selectorlist");h.on(t.eventtype,function(n){n.preventDefault();t.drawningboard.selector.closecontext();t.selectboxstate?(u.hide(),t.selectboxstate=!1):(t.loadselectlist(),u.show(),t.selectboxstate=!0,t.dom.find(".fontbox .fontlist").hide(),t.fontliststate=!1)});t.dom.find(".multiple .direction-1").on(t.eventtype,function(i){i.preventDefault();n.attr("readonly",!1);t.color.rotation=t.color.rotation==0?180:0;t.color.type="linear";t.updatespinvalue(t.color.rotation)});t.dom.find(".multiple .direction-2").on(t.eventtype,function(i){i.preventDefault();n.attr("readonly",!1);t.color.rotation=t.color.rotation==90?270:90;t.color.type="linear";t.updatespinvalue(t.color.rotation)});t.dom.find(".multiple .direction-3").on(t.eventtype,function(i){i.preventDefault();n.attr("readonly",!1);t.color.rotation=t.color.rotation==225?45:225;t.color.type="linear";t.updatespinvalue(t.color.rotation)});t.dom.find(".multiple .direction-4").on(t.eventtype,function(i){i.preventDefault();n.attr("readonly",!1);t.color.rotation=t.color.rotation==135?315:135;t.color.type="linear";t.updatespinvalue(t.color.rotation)});t.dom.find(".multiple .direction-radial").on(t.eventtype,function(i){i.preventDefault();n.attr("readonly",!0);t.color.rotation=0;t.color.type="radial";t.color.origin=t.color.origin=="in"?"out":"in";t.updatespinvalue(t.color.rotation)});t.drawningboard.isTouch&&t.dom.find(".command-item").addClass("no-hover");t.dom.find(".move-up").on(t.eventtype,function(n){n.preventDefault();t.drawningboard.selector.moveup(1);t.drawningboard.selector.contextaction=!0;t.preholdinterval=setInterval(function(){t.holdinterval=setInterval(function(){clearInterval(t.preholdinterval);t.drawningboard.selector.moveup(1)},50)},200)});t.dom.find(".move-down").on(t.eventtype,function(n){n.preventDefault();t.drawningboard.selector.movedown(1);t.drawningboard.selector.contextaction=!0;t.preholdinterval=setInterval(function(){t.holdinterval=setInterval(function(){clearInterval(t.preholdinterval);t.drawningboard.selector.movedown(1)},50)},200)});t.dom.find(".move-right").on(t.eventtype,function(n){n.preventDefault();t.drawningboard.selector.moveright(1);t.drawningboard.selector.contextaction=!0;t.preholdinterval=setInterval(function(){t.holdinterval=setInterval(function(){clearInterval(t.preholdinterval);t.drawningboard.selector.moveright(1)},50)},200)});t.dom.find(".move-left").on(t.eventtype,function(n){n.preventDefault();t.drawningboard.selector.moveleft(1);t.drawningboard.selector.contextaction=!0;t.preholdinterval=setInterval(function(){t.holdinterval=setInterval(function(){clearInterval(t.preholdinterval);t.drawningboard.selector.moveleft(1)},50)},200)});t.dom.find(".flip-horizontal").on(t.eventtype,function(n){n.preventDefault();t.drawningboard.ownermode&&t.drawningboard.selector.targethavecompanytext()||(t.drawningboard.selector.fliphorizontal(),t.drawningboard.selector.contextaction=!0)});t.dom.find(".flip-vertical").on(t.eventtype,function(n){n.preventDefault();t.drawningboard.ownermode&&t.drawningboard.selector.targethavecompanytext()||(t.drawningboard.selector.flipvertical(),t.drawningboard.selector.contextaction=!0)});t.dom.find(".layer-up").on(t.eventtype,function(n){n.preventDefault();t.drawningboard.selector.front();t.drawningboard.selector.contextaction=!0});t.dom.find(".layer-down").on(t.eventtype,function(n){n.preventDefault();t.drawningboard.selector.back();t.drawningboard.selector.contextaction=!0});t.dom.find(".layer-up-all").on(t.eventtype,function(n){n.preventDefault();t.drawningboard.selector.frontall();t.drawningboard.selector.contextaction=!0});t.dom.find(".layer-down-all").on(t.eventtype,function(n){n.preventDefault();t.drawningboard.selector.backall();t.drawningboard.selector.contextaction=!0});t.dom.find(".command-item.copy").on(t.eventtype,function(n){n.preventDefault();t.drawningboard.selector.copy();t.drawningboard.selector.paste();t.drawningboard.selector.contextaction=!0});t.dom.find(".command-item.group").on(t.eventtype,function(n){n.preventDefault();t.drawningboard.ownermode&&t.drawningboard.selector.targethavecompanytext()||(t.drawningboard.selector.group(),t.drawningboard.selector.contextaction=!0)});t.dom.find(".scale-up").on(t.eventtype,function(n){n.preventDefault();t.drawningboard.selector.upscale();t.drawningboard.selector.contextaction=!0;t.preholdinterval=setInterval(function(){t.holdinterval=setInterval(function(){clearInterval(t.preholdinterval);t.drawningboard.selector.upscale()},50)},200)});t.dom.find(".scale-down").on(t.eventtype,function(n){n.preventDefault();t.drawningboard.selector.downscale();t.drawningboard.selector.contextaction=!0;t.preholdinterval=setInterval(function(){t.holdinterval=setInterval(function(){clearInterval(t.preholdinterval);t.drawningboard.selector.downscale()},50)},200)});t.dom.find(".rotate-left").on(t.eventtype,function(n){n.preventDefault();t.drawningboard.ownermode&&t.drawningboard.selector.targethavecompanytext()||(t.drawningboard.selector.rotateleft(),t.drawningboard.selector.contextaction=!0,t.preholdinterval=setInterval(function(){t.holdinterval=setInterval(function(){clearInterval(t.preholdinterval);t.drawningboard.selector.rotateleft()},50)},200))});t.dom.find(".rotate-right").on(t.eventtype,function(n){n.preventDefault();t.drawningboard.ownermode&&t.drawningboard.selector.targethavecompanytext()||(t.drawningboard.selector.rotateright(),t.drawningboard.selector.contextaction=!0,t.preholdinterval=setInterval(function(){t.holdinterval=setInterval(function(){clearInterval(t.preholdinterval);t.drawningboard.selector.rotateright()},50)},200))});t.dom.find(".align-action-left").on(t.eventtype,function(n){n.preventDefault();t.dom.find(".align-text .command-action").removeClass("active");t.dom.find(".align-action-left").addClass("active");t.updatealignment("left")});t.dom.find(".align-action-center").on(t.eventtype,function(n){n.preventDefault();t.dom.find(".align-text .command-action").removeClass("active");t.dom.find(".align-action-center").addClass("active");t.updatealignment("center")});t.dom.find(".align-action-right").on(t.eventtype,function(n){n.preventDefault();t.dom.find(".align-text .command-action").removeClass("active");t.dom.find(".align-action-right").addClass("active");t.updatealignment("right")});f=function(n){n.preventDefault();var i=$(n.currentTarget).hasClass("reshape-action-up")?"up":"down",f=t.target.curvedline.type,u=t.target.curvedline,r=!u.enabled||i!==f;r&&!u.enabled&&t.target.initcurvedata();u.enabled=r;t.dom.find(".curved-text .command-action").removeClass("active");t.dom.find(".reshape-action-down").toggleClass("active",r&&i==="down");t.dom.find(".reshape-action-up").toggleClass("active",r&&i==="up");t.target.curvedline.type=i;t.drawningboard.selector.reshape();t.drawningboard.flowtab.pushstate()};t.dom.find(".reshape-action-up").on(t.eventtype,f);t.dom.find(".reshape-action-down").on(t.eventtype,f);t.dom.find(".letterspacing-slider").slider({orientation:"horizontal",range:"min",max:i,value:0,slide:t.updateletterspacing,change:t.applychangeletterspacing});e=function(n){n.preventDefault();var r=parseFloat(n.currentTarget.value);r=Math.min(Math.max(r,0),i);t.textpanel.find(".letterspacing-slider").slider("value",r)};t.textpanel.find(".command-action-slider-input input").on("keyup",e).on("keydown",function(n){n.stopPropagation()}).on("change",e);t.dom.find(".delete").on(t.eventtype,function(n){n.preventDefault();t.drawningboard.ownermode&&t.drawningboard.selector.targethavecompanytext()||(t.drawningboard.selector.delete(),t.drawningboard.selector.contextaction=!0)});t.dom.find(".command-item").on(t.eventleavetype,function(n){n.preventDefault();clearInterval(t.holdinterval);clearInterval(t.preholdinterval);t.drawningboard.selector.contextrelease()});t.dom.find(".copy-colors").on(t.eventtype,function(n){n.preventDefault();t.drawningboard.selector.copycolors()});t.dom.find(".paste-colors").on(t.eventtype,function(n){n.preventDefault();t.drawningboard.selector.pastecolors()})};t.updatecolor=function(){t.target instanceof Array?$.each(t.target,function(n,i){i.color=t.color.clone();i.update()}):(t.target.color=t.color.clone(),t.target.update())};t.updateletterspacing=function(){var i=t.target.textpath,n=t.textpanel.find(".letterspacing-slider").slider("value");t.textpanel.find(".command-action-slider-input input").val(n);i&&(i.setProps({letterSpacing:n||0}),t.target.format.letterspacing=n,t.target.update(),t.drawningboard.selector.gettargetdata(),t.drawningboard.selector.update())};t.applychangeletterspacing=function(n){t.updateletterspacing(n);t.drawningboard.flowtab.pushstate()};t.start()}