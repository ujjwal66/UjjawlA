SvgTools=function(){this.getthumb=function(n,t,r,u,f){function g(n){var e=['xmlns:ns1=""','xmlns:NS1=""','xmlns:NS2=""','xmlns:NS3=""','xmlns:ns2=""','xmlns:ns3=""','xmlns:inkscape=""','xmlns:sodipodi=""','xmlns:sketch=""','i:knockout="Off"'],o,t,l,r;for(i=0;i<e.length;i++)n.svg=n.svg.replace(new RegExp(e[i],"g"),"");o=$(n.svg);t=Snap(o[0]);n.gradient=new Gradient;n.gradient.decode(n.color);var s="path, polygon, rect, circle, ellipse, polyline",f={},c=t.selectAll(s)[0].attr();f.fill=n.gradient.getsvgcolor(t);l=t.selectAll("path");l.items.forEach(function(n){var i=n.attr("d"),t=i.match(/[A-Za-z]/g);t&&t.length<2&&n.remove()});for(r in c)c.hasOwnProperty(r)&&(r.match(/:/g)||[]).length>1&&(f[r]="");t.selectAll(s).attr(f);var a=h.snapgroup.g(),u={x:n.width/2*n.scale_x-n.width*n.flip_x*n.scale_x,y:n.height/2*n.scale_y-n.height*n.flip_y*n.scale_y},v=parseFloat(n.offset_x-u.x),y=parseFloat(n.offset_y-u.y),p=n.scale_x*(parseInt(n.flip_x)?-1:1),w=n.scale_y*(parseInt(n.flip_y)?-1:1),b=parseInt(calc.fixDegree(n.rotation));a.attr({transform:"translate("+v+","+y+") rotate("+b+","+u.x+","+u.y+") scale("+p+","+w+")"});a.append(t)}function nt(n){function rt(t){var s,e,f,h;t&&console.error(t);c&&!i.enabled&&(u=o.getTextWidth(),n.width!=u&&(s=n.offset_x-(u-n.width)*n.scale_x/2));a.attr("width",u);a.attr("height",n.height+60);a.css("overflow","visible");e={textAnchor:"middle",letterSpacing:r.letterspacing||0,side:i.type==="down"&&i.enabled?"right":"left",offset:i.enabled||c?.5:0,dy:0,x:0,y:0,space:"preserve"};c||i.enabled?i.enabled||d.attr({transform:"matrix(1 0 0 1 0 "+n.height*.75+")"}):(e.dy=n.height*.75,e.x=n.width*.5);o.setProps(e).render();f=i.enabled?{x:n.width/2*n.scale_x-n.width*n.flip_x*n.scale_x,y:n.height/2*n.scale_y-n.height*n.flip_y*n.scale_y}:{x:n.width/2*n.scale_x-n.width*n.flip_x*n.scale_x,y:n.height/2*n.scale_y-n.height*n.flip_y*n.scale_y};h=s?parseFloat(s-f.x):parseFloat(n.offset_x-f.x);var l=parseFloat(n.offset_y-f.y),y=n.scale_x*(parseInt(n.flip_x)?-1:1),p=n.scale_y*(parseInt(n.flip_y)?-1:1),w=parseInt(calc.fixDegree(n.rotation));k.attr({transform:"translate("+h+","+l+") rotate("+w+","+f.x+","+f.y+") scale("+y+","+p+")"});g.attr({fill:n.gradient.getsvgcolor(v)});$(n).data("ready",!0)}var a=$("<svg width='90' height='90'><\/svg>"),v=Snap(a[0]),u,l,y,p,w,nt,tt,b;n.gradient=new Gradient;n.gradient.decode(n.color);var k=h.snapgroup.g(),d=v.g(),e=null,r=Textformat.fromObj(JSON.parse(n.format)),i=JSON.parse(n.curvedline);i.enabled&&(e=v.path(),e.attr({fill:"none",d:"M"+i.left.x+","+i.left.y+" C"+i.anchorleft.x+","+i.anchorleft.y+" "+i.anchorright.x+","+i.anchorright.y+" "+i.right.x+","+i.right.y}));u=n.width;s.push(r.font);var it=r.getFontFileName(),o=new TextPath,g=Snap(o.getElement()),f={space:"preserve",fontScale:"contain"};e&&(o.setPath(e.node),e.remove());d.append(g);k.append(v);t&&t.trim()!=""&&t!="false"?(l="",r.text.trim().replaceAll("  "," ").replaceAll("  "," ").toLowerCase()=="company name"?l=t:(y=t.indexOf(" "),y>0?(p=t.substring(0,y),w=t.substring(y+1)):(p=t,w=""),l=r.text.trim().toLowerCase()=="company"?p:r.text.trim().toLowerCase()=="name"?w:r.text),f.text=l,nt=r.text.length,tt=l.length,i.enabled||(u=u/nt*tt,n.width!=u&&(r.alignment=="left"?b=n.offset_x-(n.width-u)*n.scale_x/2:r.alignment=="right"&&(b=n.offset_x+(n.width-u)*n.scale_x/2)))):f.text=r.text;f.fontSize=r.size;f.letterSpacing=r.letterspacing||0;f.textAnchor="middle";f.fontSrc="/Content/clientfonts/"+it+".woff";o.setProps(f).render(rt)}function k(){var u,t=-1,n=window.navigator.userAgent,i=n.indexOf("MSIE "),f=n.indexOf("Trident/"),r;return i>0?t=parseInt(n.substring(i+5,n.indexOf(".",i)),10):f>0&&(r=n.indexOf("rv:"),t=parseInt(n.substring(r+3,n.indexOf(".",r)),10)),t>-1?t:u}var h=this,c=!1,o,a,y,l,e,s,v,p,w;if(typeof u=="undefined"?u=!1:c=!0,typeof f=="undefined"&&(f=!1),this.svg=f?$("<svg class='thumb' width='600' height='600'><\/svg>"):$("<svg class='thumb' width='"+n.width+"' height='"+n.height+"'><\/svg>"),o={svg:this.svg},s=[],this.snapitem=Snap(this.svg[0]),this.snapgroup=this.snapitem.g(),this.snapitem.attr({viewBox:"0,0,"+this.svg.attr("width")+","+this.svg.attr("height")}),n.background_color&&(a=this.snapitem.g(),a.attr({elementType:"background"}),y=a.rect(0,0,this.svg.attr("width"),this.svg.attr("height")),l=new Gradient,l.colorlist.push(new Color(n.background_color)),l.colorlist.push(new Color(n.background_color)),y.attr("fill",l.getsvgcolor(this.snapitem))),e=[],n.shape_list&&n.shape_list.length>0&&$.each(n.shape_list,function(n,t){e[t.index]=[t,"shape"]}),n.text_list&&n.text_list.length>0&&$.each(n.text_list,function(n,t){e[t.index]=[t,"text"]}),e&&e.length>0&&$.each(e,function(n){e[n]&&(e[n][1]=="shape"?g(e[n][0]):e[n][1]=="text"&&($(e[n][0]).data("ready",!1),nt(e[n][0],c,f)))}),n.text_list&&n.text_list.length>0&&s.length>0&&r&&(s=s.filter(function(n,t,i){return t==i.indexOf(n)}),v=[],$.each(s,function(n,t){$.each(r,function(n,i){t==i.name&&v.push(i.googleimportstring)})}),p=v.join("|"),w='<style type="text/css">@import url("https://fonts.googleapis.com/css?family='+p+'");<\/style>',o.svg.find("defs").first().append(w)),k()&&k()<=11||(o.svg.attr("xmlns","http://www.w3.org/2000/svg"),o.svg.attr("xmlns:inkscape","http://www.inkscape.org/namespaces/inkscape"),o.svg.attr("xmlns:sodipodi","http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"),o.svg.attr("xmlns:xlink","http://www.w3.org/1999/xlink"),o.svg.attr("xmlns:ns1","http://www.inkscape.org/namespaces/inkscape"),o.svg.attr("xmlns:sketch","http://www.bohemiancoding.com/sketch/ns")),o.svg.find("desc").remove(),u){function d(){for(var t=!0,n=1;n<e.length;n++)e[n][1]!="text"||$(e[n][0]).data("ready")||(t=!1);return t}function b(){if(d()){if(isIE()||(o.svg[0].innerHTML=o.svg[0].innerHTML.replace(/NS\d+:href/g,"xlink:href")),f){$("body").append(h.svg);var i=h.snapitem.select('g:not([elementtype="background"])'),t=i.getBBox(),n=540/t.height;t.width*n>540&&(n=540/t.width);translatex=(600-t.width*n)/2-t.x*n;translatey=(600-t.height*n)/2-t.y*n;i.attr({transform:"matrix("+n+" 0 0 "+n+" "+translatex+" "+translatey+")"});h.snapitem.append(i);h.svg.remove()}u(o.svg)}else setTimeout(b,500)}b()}else return o}}